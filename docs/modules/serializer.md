# Serializer 

The main class of this module is `WritePosLogsToJsonSerializer`, where the log file of the position are read and then optimize.
Most of the method here work on the hypotesis that the background is always white (255 as value) -> this is the reason why the watermark is applied later.

## type of Optmization
The first distinction in the optimization is done between Heading bboxes or standard bboxes.
The `optimizer` class takes in input the GT data (generated by latex and previously read) and a list of images (exported by the pdf). The a list of optimizations is applied:

### Remove empty bboxes
A box is considered empty if the vertical lenght is less than the current template pixel dimension of the font - a certain margin value found empirically.
The index of all the empty bboxes is then collected and used to remove all the unnecesary ones.

### Crops section 
This optimization only apply to the crop section and is done in order to remove the white lines that always remains on top of the section bounding box (due to the baseline of the previous element very distant)

### separate item bboxes
If there is some intersection between bounding boxes, this method takes care of it.
How this works is: 
- 1: Crop the page image around the item bounding box.
- 2: Move the border down until it's all white (we want to find the real space of separation).
- 3: we generate the new bounding box and if it's not all white, we consider it the new one.

### adjust the fit
Optimize each of the borders of the bbox, it divide ricursively the image and always check the left part. When the left part is all white, we can remove that part and add the offset as a offset.